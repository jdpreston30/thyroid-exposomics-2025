# Thyroid Exposomics Analysis
This repository contains code and data used for the analysis presented in the submitted manuscript 'Environmental Chemical Burden in Differentiated Thyroid Cancer' by Preston et al. 2025.


## Requirements
- R version >= 4.3.1
- Packages: broom, dplyr, forcats, ggplot2, multcompView, purrr, readxl, stringr, tibble, tidyr, writexl


## Files
All elements of the repository are listed below, along with a description and guide of each:
- `source_code.R`: This file is the main analysis script for the project. All data required to run the code, excluding data required for the blocks under “#+ Demographics (Table 1)”, can be imported from the "Data and Metadata Files" folder or loaded into the global environment from the compiled R serialized object (all_objects.rds). The following packages are required for the source code: broom, dplyr, forcats, ggplot2, multcompView, purrr, readxl, stringr, tibble, tidyr, writexl. These can all be installed and loaded under the header “#* Dependencies.” A version of R ≥ 4.3.1 is recommended for running all analyses in the source code.

- `all_objects.rds`: This is the R serialized object containing all objects and the full dataset, excluding demographic data.

- `Data and Metadata Files`: This folder contains all primary data and metadata files. These data can be directly imported into the analysis script. A description of each file is as follows:
  - `primary_data.xlsx`: This file contains the primary data for this project. A description of each tab in the file is as follows:
    - `lib.subject.summary`: Feature table for all annotated features.
    - `tumors_sequence`: Sequence file and associated sample metadata.
    - `lib.subject.qusummary`: Quantitative feature table for tumors.
    - `lib.subject.qsummary.cadaver`: Quantitative feature table for cadaver control thyroids.
    - `library`: Information on the full library of standards used.
    - `tissue_weights`: Weights of each tissue sample.
  - `chemical_metadata.xlsx`: Metadata for all detected chemicals.
    - `feature_metadata`: Detailed metadata for all unique identifications.
    - `Endogenous Excluded Features`: Features excluded from analysis due to being primarily endogenous.

- `Outputs`: This folder contains all output data files generated by running the source code.

- `Figures.Prism`: This is a GraphPad Prism file used to create all figures in the manuscript.
